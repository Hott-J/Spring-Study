## :cherry_blossom: 회원 관리 예제 - 웹 MVC 개발

### 1. 회원 웹 기능 - 홈 화면 추가
* HomeController 추가
```java
@Controller
public class HomeController {

    @GetMapping("/")
    public String home() {
        return "home";  // templates 폴더 내에 있는 home.html 을 찾는다.
    }
}
```
* static/index.html(Spring boot가 제공하는 Welcome page 기능)과 templates/home.html("/" Mapping) 중 무엇이 더 우선순위가 높을까?
  * 우선, HTTP 요청이 오면 Spring Container 내에 있는 관련 Controller가 있는지 찾는다. 없으면 그때 static file을 반환한다.
  * HTTP 요청으로 맨 처음 "/"가 오는데, "/"에 mapping되는 Controller가 있으면 templates 내에 있는 html 파일을 리턴한다. 이렇게 되면 static file은 무시된다.
  * @GetMapping("/")을 처리하는 Controller를 지우면 다시 static file이 등장하게 될 것이다.
  * 결국, Controller가 정적 파일보다 우선순위가 높다고 할 수 있다!

### 2. 회원 웹 기능 - 등록
* 회원 등록 폼 Controller
  * MemberController에 GetMapping("/members/new") 추가
  * templates폴더 밑에 members폴더 생성 후 createMembersForm.html 파일 생성
  ```java
  @Controller
  public class MemberController {

      private final MemberService memberService; // 하나만 만들어져 있으면 된다.

      @Autowired
      public MemberController(MemberService memberService) {
          this.memberService = memberService;
      }

      @GetMapping("/members/new")
      public String createForm() {
          return "members/createMembersForm";
      }
  }
  ```
  
* 웹 등록 화면에서 데이터를 전달 받을 폼 객체
  * templates/members/createMembersForm.html 에 있는 name="name"과 매칭된다.
  ```java
  public class MemberForm {
      private String name;

      public String getName() {
          return name;
      }

      public void setName(String name) {
          this.name = name;
      }
  }
  ```
    
* 회원 Controller에서 회원을 실제 등록하는 기능
  * MemberController에 PostMapping("/members/new") 추가
  * PostMapping : form에 data를 넣어서 전달, 등록 / GetMapping : data 조회
  ```java
  @Controller
  public class MemberController {

      private final MemberService memberService; // 하나만 만들어져 있으면 된다.

      @Autowired
      public MemberController(MemberService memberService) {
          this.memberService = memberService;
      }

      @GetMapping("/members/new")
      public String createForm() {
          return "members/createMembersForm";
      }

      @PostMapping("/members/new")
      public String create(MemberForm form) {
          Member member = new Member();
          member.setName(form.getName());
          memberService.join(member);
          return "redirect:/";
      }
  }
  ```

### 3. 회원 웹 기능 - 조회
* 회원 Controller에서 회원을 조회하는 기능
  * MemberController에 GetMapping("/members") 추가
  * templates/members폴더 밑에 memberList.html 파일 생성
  ```java
  @Controller
    public class MemberController {

        private final MemberService memberService; // 하나만 만들어져 있으면 된다.

        @Autowired
        public MemberController(MemberService memberService) {
            this.memberService = memberService;
        }

        @GetMapping("/members/new")
        public String createForm() {
            return "members/createMembersForm";
        }

        @PostMapping("/members/new")
        public String create(MemberForm form) {
            Member member = new Member();
            member.setName(form.getName());

            memberService.join(member);

            return "redirect:/";
        }

        @GetMapping("/members")
        public String list(Model model) {
            List<Member> members = memberService.findMembers(); // 모든 회원 list가 들어감.
            model.addAttribute("members", members);
            return "members/memberList";
        }
    }
    ```
<br/>

## :cherry_blossom: Spring DB 접근 기술

### 1. H2 데이터베이스 설치
* 지금까지는 메모리에 저장했기 때문에, 서버가 꺼지면 모든 data가 날라간다.
* [https://www.h2database.com](https://www.h2database.com) 사이트 접속하여 Version 1.4.200 (2019-10-14) 다운로드 및 설치
* 권한 주기 : chmod 755 h2.sh
* 실행 : h2.bat(윈도우), ./h2.sh(맥, 리눅스)
* 데이터베이스 파일 생성 방법(JDBC URL)
  * jdbc:h2:~/test(최초 한번만)
  * ~/test.mv.db 파일 생성 확인하기
  * 이후부터는 jdbc:h2:tcp://localhost/~/test 로 접속. (파일로 접속할 경우 application과 웹 콘솔의 충돌이 일어날 수 있다.)
* 테이블 생성하기
  * 테이블 관리를 위해 프로젝트 루트에 sql/ddl.sql 파일을 생성
  ```
  drop table if exists member CASCADE;
  create table member
  (
    id bigint generated by default as identity,
    name varchar(255),
    primary key (id)
  );
  ```
  * 테이블 data 조회
  ```
  SELECT * FROM MEMBER
  ```
  * 테이블 data 추가(id는 generated by default as identity설정되어 있어서, 값 입력 안해도 자동으로 설정됨)
  * 이유는 모르겠지만 values("spring") 쌍따옴표 사용하면 에러가 나서 홑따옴표를 사용하였다.
  ```
  insert into member(name) values('spring')
  ```
  
### 2. 순수 JDBC
